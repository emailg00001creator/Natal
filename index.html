<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Natal AR - For√ßado</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        #splash {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #2c3e50; color: white; z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        button {
            padding: 20px 40px; font-size: 20px; background: #e74c3c;
            color: white; border: none; border-radius: 50px; font-weight: bold;
        }
    </style>
</head>

<body style="margin: 0; overflow: hidden;">

    <div id="splash">
        <h1>üéÑ Cart√£o de Natal üéÅ</h1>
        <p>Precisamos de acesso √† c√¢mera e som</p>
        <button id="btnIniciar">ENTRAR AGORA</button>
    </div>

    <a-scene id="minhaCena" style="display: none;" embedded arjs="sourceType: webcam; debugUIEnabled: false;">
        <a-assets>
            <audio id="musica" src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3" preload="auto"></audio>
        </a-assets>

        <a-entity camera look-controls>
            <a-entity position="0 -1 -3">
                <a-cone color="green" radius-bottom="0.5" height="1"></a-cone>
                <a-sphere color="yellow" radius="0.1" position="0 0.6 0"></a-sphere>
                <a-text value="FELIZ NATAL!" align="center" position="0 1 0" color="red"></a-text>
            </a-entity>
        </a-entity>
    </a-scene>

    <script>
        document.getElementById('btnIniciar').addEventListener('click', function() {
            // 1. Tenta for√ßar o pedido da c√¢mera manualmente
            navigator.mediaDevices.getUserMedia({ video: true, audio: false })
            .then(function(stream) {
                // Se der certo, inicia a cena e o som
                document.getElementById('splash').style.display = 'none';
                document.getElementById('minhaCena').style.display = 'block';
                
                const audio = document.querySelector('#musica');
                audio.play();
                
                console.log("C√¢mera e √Åudio iniciados");
            })
            .catch(function(err) {
                alert("Erro: Voc√™ precisa permitir a c√¢mera nas configura√ß√µes do navegador! Nome do erro: " + err.name);
                console.error(err);
            });
        });
    </script>
</body>
</html>
